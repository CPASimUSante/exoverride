{% form_theme form 'ClarolineCoreBundle::form_theme_no_label.html.twig' %}
{# {{ path('cpasimusante_statwidget_config', {'widget': widgetInstance.getId()}) }}#}
<form role="form"
      class="form-horizontal"
      action="#"
      method="post"
      novalidate
        >
    <div class="panel-body">

        <table class="table">
            <tr id="pick-user-for-stats">
                <td class="isel_label">{{ form.userlist.vars.label }}</td>
                <td class="isel_widget">{{ form_widget(form.userlist) }}</td>
                <td class="isel_widget">
                    <i class="fa fa-user-plus pointer-hand pull-right"
                       id="pick-user-for-stats-btn"
                       data-placement="left"
                       title="{{ 'pick_user_for_stat'|trans({}, 'resource') }}"></i>
                </td>
            </tr>
            <tr>
                <td class="isel_label">{{ form.resourcelist.vars.label }}</td>
                <td class="isel_widget">{{ form_widget(form.resourcelist) }}</td>
                <td class="isel_widget">{{ form_errors(form.resourcelist) }}</td>
            </tr>
        </table>

    </div>
    <div class="panel-footer">
        <button type="submit" class="btn btn-primary">{{ 'ok'|trans({}, 'platform') }}</button>
        <a href="#">
            <button type="button" class="btn btn-default claro-widget-form-cancel">{{ 'cancel'|trans({}, 'platform') }}</button>
        </a>
    </div>
</form>

<script type="text/javascript">
    $(document).ready(function() {
        var allUsersInWS = '';

        $.ajax({
            url: Routing.generate('cpasimusante_get_user_in_ws', {}),
            type: 'GET',
            success: function (datas) {
                allUsersInWS = (datas !== null) ? datas.join(",") : '';
            }
        });

        $('#pick-user-for-stats').on('click', '#pick-user-for-stats-btn', function () {
            var userPicker = new UserPicker();
            var settings = {
                multiple: true,
                picker_name: 'contacts_picker',
                picker_title: Translator.trans('select_users_to_add_to_graph', {},'resource'),
                whitelist: allUsersInWS
            };
            userPicker.configure(settings, addUsersToGraph);
            userPicker.open();
        });
        addUsersToGraph = function(userIds)Â {
            if (userIds !== null) {
                $('#cpasimusante_exoverridebundle_exoverridestatconfig_userlist').val(userIds);
            }
        };
/*
        var allContactIdsTxt = '' + $('#contacts-datas-box').data('contacts-id');
        var allContactIds = allContactIdsTxt !== '' ?
                allContactIdsTxt.split(',') :
*/
    });
</script>